<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>SwitchBot起動</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- =======================
       CSS：中央配置・文字スタイル
       ======================= -->
  <style>
    html, body {
      height: 100%;             /* 画面全体を使用 */
      margin: 0;                /* デフォルト余白を削除 */
      padding: 0;
      display: flex;            /* フレックスボックスで中央配置 */
      justify-content: center;   /* 水平方向中央 */
      align-items: center;      /* 垂直方向中央 */
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f8f8f8; /* 背景色 */
    }
    p {
      font-size: 20px;          /* 大きめ文字 */
      font-weight: bold;        /* 太字 */
      color: #333;
      line-height: 1.5;         /* 行間 */
      margin: 0 20px;           /* 横余白でスマホ画面にフィット */
    }
    small {
      display: block;           /* 改行して下に表示 */
      margin-top: 10px;
      font-size: 14px;          /* バージョン文字小さめ */
      color: #666;
    }
  </style>

  <!-- =======================
       JavaScript：アプリ起動＆キャッシュバスター
       バージョンを一括管理
       ======================= -->
  <script>
    window.onload = function() {

      // ① バージョン番号をここだけで管理
      //    HTML表示とURLキャッシュバスターに自動反映されます
      var appVersion = "V04";

      // ② ユーザーエージェント取得（端末判定用）
      var ua = navigator.userAgent || navigator.vendor || window.opera;

      // ③ アプリURL（キャッシュバスターとしてバージョンを付与）
      var appURL = "switchbot://?v=" + appVersion;

      // ④ iOS App Store URL（キャッシュバスターとしてバージョン付与）
      var storeURL_iOS = "https://apps.apple.com/jp/app/switchbot/id1087374761?v=" + appVersion;

      // ⑤ Android Google Play URL（キャッシュバスターとしてバージョン付与）
      var storeURL_Android = "https://play.google.com/store/apps/details?id=com.theswitchbot.switchbot&v=" + appVersion;

      // ⑥ iOS端末判定
      if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) {
        // アプリを起動
        window.location.href = appURL;

        // アプリ未インストール時は2秒後にApp Storeに誘導
        setTimeout(function(){ window.location.href = storeURL_iOS; }, 2000);
      }
      // ⑦ Android端末判定
      else if (/android/i.test(ua)) {
        // アプリを起動
        window.location.href = appURL;

        // アプリ未インストール時は2秒後にGoogle Playに誘導
        setTimeout(function(){ window.location.href = storeURL_Android; }, 2000);
      }
      // ⑧ その他（PCやタブレットなど）
      else {
        // 案内メッセージを表示
        document.body.innerHTML = "<p>スマートフォンからアクセスしてください。</p>";
      }

      // ⑨ HTML内の <small> にバージョン番号を自動反映
      //     <small id="version"></small> を事前にHTMLに置く必要があります
      var versionElem = document.getElementById("version");
      if(versionElem) {
        versionElem.textContent = "バージョン: " + appVersion;
      }
    }
  </script>
</head>
<body>
  <!-- =======================
       ユーザーへの案内メッセージ
       バージョンはJSで自動反映
       ======================= -->
  <p>
    SwitchBotアプリを起動しました。<br><br>
    完了したらこのタブを閉じてください。<br><br>
    <small id="version"></small> <!-- ここにJSでバージョンが入る -->
  </p>
</body>
</html>
